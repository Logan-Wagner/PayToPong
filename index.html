<!DOCTYPE html>
<html>
<head>
  <title>Pong</title>
  <link rel="stylesheet" href="style/index.css">
  <script src="scripts/pong.js"></script>
  <script src="scripts/paddle.js"></script>
  <script src="scripts/ball.js"></script>
  <script src="scripts/inventory.js"></script>
  <script src="scripts/shop.js"></script>
  <script src="scripts/popup.js"></script>
  <script src="scripts/cookies.js"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
  <link rel="manifest" href="./favicon/site.webmanifest">
</head>
<body>
  <div id="top">
    <h1>Welcome to Pong!!</h1>
  </div>
  <div id="middle">
    <div class="col" id="left">
      <div> <button type="button"> Toggle Multiplayer </button> </div>
      <div id="shop">
        <div class="container">
          <div id="shopTitle"> <h3>SHOP</h3> </div>
          <div id="coins"> $0 </div> 
        </div> 
        <h4>Recommended:</h4>
        <div class="shopItem"> <button onclick="shop.buy('Chaos',5)"> <p id="item1">Chaos <br> $5 </p> </button> </div>
        <div class="shopItem"> <button onclick="shop.buy('Future Sight',40)"> <p id="item2">Future Sight<br> $40 </p> </button> </div>
        <div class="shopItem"> <button onclick="shop.buy('Reverse',25)"> <p id="item3">Reverse<br> $25 </p> </button> </div>
        <div> <a href="shop.html"> <button type="button"> <p> Shop more </p> </button> </a> </div>
      </div>
    </div>
    <div class="col" id="center">
      <canvas id="game"></canvas>
      <div class="container">
        <button type="button" onclick="game.start()">Play</button>
        <button type="button" onclick="game.pause()">Pause</button>
      </div>
      <div id="powerups">
        <h2> Inventory </h2>
        <div class="container">
            <div class="slot"> <button class="slotPress" onclick="inv.use(1)"> <p id="slot1">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(2)"> <p id="slot2">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(3)"> <p id="slot3">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(4)"> <p id="slot4">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(5)"> <p id="slot5">_</p> </button> </div>
        </div>
      </div>
    </div>
    <div class="col" id="right">
      <div id="ads">
        <div class="container">
          <div id="left">
              <div id="vert-container">
                  <div class="ad">
                      <button class="adPress" onclick="coin5Popup.open()"> <p> Click here to gain 5 coins </p> </button>
                  </div>
  
                  <div class="ad">
                      <button class="adPress" onclick="coin10Popup.open()"> <p> Click here to gain 10 coins </p> </button>
                  </div>
  
                  <div class="ad">
                      <button class="adPress" onclick="coin20Popup.open()"> <p> Click here to gain 20 coins </p> </button>
                  </div>
              </div>
          </div>
      </div>
    </div>
  </div>
  <div id="overlay"></div>
  <div class="popup" id="coin5">
      <div class="popupcontrols">
          <span id="popupclose"> <button class="close" onclick="coin5Popup.close()">X</button> </span>
      </div>
      <div class="popupcontent">
          <h1 id="coin5Time"> 00:3 </h1> 
      </div>  
  </div>
  <div class="popup" id="coin10">
      <div class="popupcontrols">
          <span id="popupclose"> <button class="close" onclick="coin10Popup.close()">X</button> </span> <br>
      </div>
      <div class="popupcontent">
          <h1 id="coin10Time"> 00:7 </h1> 
      </div>
  </div>

  <div class="popup" id="coin20">
      <div class="popupcontrols">
          <span id="popupclose"> <button class="close" onclick="coin20Popup.close()">X</button> </span>
      </div>
      <div class="popupcontent">
          <h1 id="coin20Time"> 00:15 </h1> 
          <!--<iframe width=500 height=250 src="https://www.youtube.com/embed/Pv0iVoSZzN8?si=_WL-h0lk7dJn_FM7&autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>-->
      </div>      
  </div>

  <script type="text/javascript">
    var inv;
    var shop;
    var bank  = getCookie("bank");
    var slot1 = getCookie("slot1");
    var slot2 = getCookie("slot2");
    var slot3 = getCookie("slot3");
    var slot4 = getCookie("slot4");
    var slot5 = getCookie("slot5");

    if (bank != "" && slot1 != "" && slot2 != "" && slot3 != "" && slot4 != "" && slot5 != "") {
        // copied over inventory and shop
        inv = new Inventory(slot1, slot2, slot3, slot4, slot5); // a simple class that stores power-ups
        shop = new Shop(inv, parseInt(bank)); // used to actually define the shop
        console.log("loaded from storage");

    } else {
        // new local instances of inventory and shop
        setCookie("bank",  200, 7, "./shop.html")
        setCookie("slot1", "_", 7, "./shop.html");
        setCookie("slot2", "_", 7, "./shop.html");
        setCookie("slot3", "_", 7, "./shop.html");
        setCookie("slot4", "X", 7, "./shop.html");
        setCookie("slot5", "X", 7, "./shop.html");

        inv = new Inventory("_","_","_","X","X"); // a simple class that stores power-ups
        shop = new Shop(inv, 200); // used to actually define the shop
        console.log("Default setup method");
    }

    window.onload = function() {
        shop.updateBank();
        inv.updateSlot(1);
        inv.updateSlot(2);
        inv.updateSlot(3);
        inv.updateSlot(4);
        inv.updateSlot(5);
    };

    window.onclose = function() {
        setCookie("bank",  shop.bank, 7, "./shop.html");
        setCookie("slot1", inv.slot1, 7, "./shop.html");
        setCookie("slot2", inv.slot2, 7, "./shop.html");
        setCookie("slot3", inv.slot3, 7, "./shop.html");
        setCookie("slot4", inv.slot4, 7, "./shop.html");
        setCookie("slot5", inv.slot5, 7, "./shop.html");
    };

    window.onabort = function() {
        setCookie("bank",  shop.bank, 7, "./shop.html");
        setCookie("slot1", inv.slot1, 7, "./shop.html");
        setCookie("slot2", inv.slot2, 7, "./shop.html");
        setCookie("slot3", inv.slot3, 7, "./shop.html");
        setCookie("slot4", inv.slot4, 7, "./shop.html");
        setCookie("slot5", inv.slot5, 7, "./shop.html");
    };

    coin5Popup = new Popup(5,3,shop);
    coin10Popup = new Popup(10,7,shop);
    coin20Popup = new Popup(20,15,shop);

    var game = new Pong("game");
    game.setup();

  </script>
</body>
</html>
