<!DOCTYPE html>
<html>
<head>
  <title>Pong</title>
  <link rel="stylesheet" href="style/index.css">
  <script src="scripts/pong.js"></script>
  <script src="scripts/paddle.js"></script>
  <script src="scripts/ball.js"></script>
  <script src="scripts/inventory.js"></script>
  <script src="scripts/shop.js"></script>
  <script src="scripts/popup.js"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
  <link rel="manifest" href="./favicon/site.webmanifest">
</head>
<body>
  <div class="title_header" id="top">
    <div><h1>Welcome to Pong!!</h1></div>
    <div> <a href="about.html"> <button onclick=""> <p> ? </p> </button> </a> </div>
  </div>
  <div id="middle">
    <div class="col" id="left">
      <div> <button type="button"> Toggle Multiplayer </button> </div>
      <div id="shop">
        <div class="container">
          <div id="shopTitle"> <h3>SHOP</h3> </div>
          <div id="coins"> $0 </div> 
        </div> 
        <h4>Recommended:</h4>
        <div class="shopItem"> <button onclick="shop.buy('Chaos',5)"> <p id="item1">Chaos <br> $5 </p> </button> </div>
        <div class="shopItem"> <button onclick="shop.buy('Future Sight',40)"> <p id="item2">Future Sight<br> $40 </p> </button> </div>
        <div class="shopItem"> <button onclick="shop.buy('Reverse',25)"> <p id="item3">Reverse<br> $25 </p> </button> </div>
        <div> <a href="shop.html"> <button type="button"> <p> Shop more </p> </button> </a> </div>
      </div>
    </div>
    <div class="col" id="center">
      <canvas id="game"></canvas>
      <div class="container">
        <button type="button" onclick="game.start()">Play</button>
        <button type="button" onclick="game.pause()">Pause</button>
      </div>
      <div id="powerups">
        <h2> Inventory </h2>
        <div class="container">
            <div class="slot"> <button class="slotPress" onclick="inv.use(1)"> <p id="slot1">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(2)"> <p id="slot2">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(3)"> <p id="slot3">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(4)"> <p id="slot4">_</p> </button> </div>
            <div class="slot"> <button class="slotPress" onclick="inv.use(5)"> <p id="slot5">_</p> </button> </div>
        </div>
      </div>
    </div>
    <div class="col" id="right">
      <div id="ads">
        <div class="container">
          <div id="left">
              <div id="vert-container">
                  <div class="ad">
                      <button class="adPress" onclick="coin5Popup.open()"> <p> Click here to gain 5 coins </p> </button>
                  </div>
  
                  <div class="ad">
                      <button class="adPress" onclick="coin10Popup.open()"> <p> Click here to gain 10 coins </p> </button>
                  </div>
  
                  <div class="ad">
                      <button class="adPress" onclick="coin20Popup.open()"> <p> Click here to gain 20 coins </p> </button>
                  </div>
              </div>
          </div>
      </div>
    </div>
  </div>
  <div id="overlay"></div>
  <div class="popup" id="coin5">
      <div class="popupcontrols">
          <span id="popupclose"> <button class="close" onclick="coin5Popup.close()">X</button> </span>
      </div>
      <div class="popupcontent">
          <h1 id="coin5Time"> 00:3 </h1> 
      </div>  
  </div>
  <div class="popup" id="coin10">
      <div class="popupcontrols">
          <span id="popupclose"> <button class="close" onclick="coin10Popup.close()">X</button> </span> <br>
      </div>
      <div class="popupcontent">
          <h1 id="coin10Time"> 00:7 </h1> 
      </div>
  </div>

  <div class="popup" id="coin20">
      <div class="popupcontrols">
          <span id="popupclose"> <button class="close" onclick="coin20Popup.close()">X</button> </span>
      </div>
      <div class="popupcontent">
          <h1 id="coin20Time"> 00:15 </h1> 
          <!--<iframe width=500 height=250 src="https://www.youtube.com/embed/Pv0iVoSZzN8?si=_WL-h0lk7dJn_FM7&autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>-->
      </div>      
  </div>

  <script type="text/javascript">
    if (localStorage.getItem("newcomer") == undefined) {
        localStorage.setItem("newcomer", true);
        console.log("Newcomer true");
    }

    if (localStorage.getItem("newcomer") == false) {
        // copied over inventory and shop
        inv = new Inventory(localStorage.getItem("slot1"), localStorage.getItem("slot2"), localStorage.getItem("slot3"), localStorage.getItem("slot4"), localStorage.getItem("slot5")); // a simple class that stores power-ups
        shop = new Shop(inv, localStorage.getItem("bank")); // used to actually define the shop
        console.log("loaded from storage");

    } else {
        // new local instances of inventory and shop
        inv = new Inventory("_","_","_","X","X"); // a simple class that stores power-ups
        shop = new Shop(inv, 200); // used to actually define the shop
        localStorage.setItem("newcomer", true);
        console.log("Default setup method");
    }

    coin5Popup = new Popup(5,3,shop);
    coin10Popup = new Popup(10,7,shop);
    coin20Popup = new Popup(20,15,shop);

    var game = new Pong("game");
    game.setup();

    window.onload = function() {
        shop.updateBank();
        inv.updateSlot(1);
        inv.updateSlot(2);
        inv.updateSlot(3);
        inv.updateSlot(4);
        inv.updateSlot(5);
    };

    window.onclose = function() {
        localStorage.setItem("bank", shop.bank);
        localStorage.setItem("slot1", inv.slot1);
        localStorage.setItem("slot2", inv.slot2);
        localStorage.setItem("slot3", inv.slot3);
        localStorage.setItem("slot4", inv.slot4);
        localStorage.setItem("slot5", inv.slot5);
    };

    window.onabort = function() {
        localStorage.setItem("bank", shop.bank);
        localStorage.setItem("slot1", inv.slot1);
        localStorage.setItem("slot2", inv.slot2);
        localStorage.setItem("slot3", inv.slot3);
        localStorage.setItem("slot4", inv.slot4);
        localStorage.setItem("slot5", inv.slot5);
    };

  </script>
</body>
</html>
