<!DOCTYPE html>

<head>
    <title>Pong Shop</title>
    <link rel="stylesheet" href="style/shop.css">
    <script type="text/javascript" src="scripts/shop.js"></script>
    <script type="text/javascript" src="scripts/inventory.js"></script>
    <script type="text/javascript" src="scripts/popup.js"></script>
    <script type="text/javascript" src="scripts/cookies.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
    <link rel="manifest" href="./favicon/site.webmanifest">
    <script type="text/javascript">
        var inv;
        var shop;
        var coin10Popup;
        var coin25Popup;
        var coin50Popup;
    </script>
    <script type="text/javascript">
        var bank  = getCookie("bank");
        var slot1 = getCookie("slot1");
        var slot2 = getCookie("slot2");
        var slot3 = getCookie("slot3");
        var slot4 = getCookie("slot4");
        var slot5 = getCookie("slot5");

        if (bank != "" && slot1 != "" && slot2 != "" && slot3 != "" && slot4 != "" && slot5 != "") {
            // copied over inventory and shop
            inv = new Inventory(slot1, slot2, slot3, slot4, slot5); // a simple class that stores power-ups
            shop = new Shop(inv, parseInt(bank)); // used to actually define the shop
            console.log("loaded from storage");

        } else {
            // new local instances of inventory and shop
            setCookie("bank",  200, 7, "./shop.html")
            setCookie("slot1", "_", 7, "./shop.html");
            setCookie("slot2", "_", 7, "./shop.html");
            setCookie("slot3", "_", 7, "./shop.html");
            setCookie("slot4", "X", 7, "./shop.html");
            setCookie("slot5", "X", 7, "./shop.html");

            inv = new Inventory("_","_","_","X","X"); // a simple class that stores power-ups
            shop = new Shop(inv, 200); // used to actually define the shop
            console.log("Default setup method");
        }

        coin10Popup = new Popup(10,15,shop);
        coin25Popup = new Popup(25,20,shop);
        coin50Popup = new Popup(50,35,shop);

        window.onload = function() {
            shop.updateBank();
            inv.updateSlot(1);
            inv.updateSlot(2);
            inv.updateSlot(3);
            inv.updateSlot(4);
            inv.updateSlot(5);
        };

        window.onclose = function() {
            setCookie("bank",  shop.bank, 7, "./shop.html");
            setCookie("slot1", inv.slot1, 7, "./shop.html");
            setCookie("slot2", inv.slot2, 7, "./shop.html");
            setCookie("slot3", inv.slot3, 7, "./shop.html");
            setCookie("slot4", inv.slot4, 7, "./shop.html");
            setCookie("slot5", inv.slot5, 7, "./shop.html");
        };

        window.onabort = function() {
            setCookie("bank",  shop.bank, 7, "./shop.html");
            setCookie("slot1", inv.slot1, 7, "./shop.html");
            setCookie("slot2", inv.slot2, 7, "./shop.html");
            setCookie("slot3", inv.slot3, 7, "./shop.html");
            setCookie("slot4", inv.slot4, 7, "./shop.html");
            setCookie("slot5", inv.slot5, 7, "./shop.html");
        };
    </script>
</head>

<html>
<body>
    <h1> 
        <div id="title-container"> 
            <div id="back"> <a href="index.html"> <button class="close"> <p> Back </p> </button> </a> </div>
            <div id="title"> Pong Shop </div>
            <div id="coins"> $0 </div> 
        </div>
    </h1>
    
    <div class="container">
        <div id="left">
            <div id="vert-container">
                <div class="ad">
                    <button class="adPress" onclick="coin10Popup.open()"> <p> Click here to gain 10 coins </p> </button>
                </div>

                <div class="ad">
                    <button class="adPress" onclick="coin25Popup.open()"> <p> Click here to gain 25 coins </p> </button>
                </div>

                <div class="ad">
                    <button class="adPress" onclick="coin50Popup.open()"> <p> Click here to gain 50 coins </p> </button>
                </div>
            </div>
            
        </div>

        <div id="right">
            <div class="container">
                <div class="item"> <button onclick="shop.buy('Double Trouble',20)"> <p> Double Trouble <br> $20 </p> </button> </div>
                <div class="item"> <button onclick="shop.buy('Mirror',50)"> <p> Mirror <br> $50 </p> </button> </div>
                <div class="item"> <button onclick="shop.buy('Gravity',70)"> <p> Gravity <br> $70 </p> </button> </div>
            </div>

            <div class="container">
                <div class="item"> <button onclick="shop.buy('Chaos',5)"> <p> Chaos <br> $5 </p> </button> </div>
                <div class="item"> <button onclick="shop.buy('Straight Shot',10)"> <p> Straight Shot <br> $10 </p> </button> </div>
                <div class="item"> <button onclick="shop.buy('Funnel',90)"> <p> Funnel <br> $90 </p> </button> </div>
            </div>

            <div class="container">
                <div class="item"> <button onclick="shop.buy('Fog of War',100)"> <p> Fog of War <br> $100 </p> </button> </div>
                <div class="item"> <button onclick="shop.buy('Future Sight',40)"> <p> Future Sight <br> $40 </p> </button> </div>
                <div class="item"> <button onclick="shop.buy('Reverse',25)"> <p> Reverse <br> $25 </p> </button> </div>
            </div>

            <div>
                <a href="coin.html"> <button class="wantPress" onclick=""> <p> Purchase coins </p> </button> </a>
            </div>

            <div>
                <a href="custom.html"> <button class="wantPress" onclick=""> <p> Purchase customizations </p> </button> </a>
            </div>

            <div>
                <button class="wantPress" onclick="shop.increaseSlots()"> <p> Buy Inventory Slot <br> $1000 </p> </button>
            </div>

        </div>
    </div>

    <h2> Inventory </h2>

    <div class="container">
        <div class="slot"> <button class="slotPress" onclick="inv.use(1)"> <p id="slot1">_</p> </button> </div>
        <div class="slot"> <button class="slotPress" onclick="inv.use(2)"> <p id="slot2">_</p> </button> </div>
        <div class="slot"> <button class="slotPress" onclick="inv.use(3)"> <p id="slot3">_</p> </button> </div>
        <div class="slot"> <button class="slotPress" onclick="inv.use(4)"> <p id="slot4">_</p> </button> </div>
        <div class="slot"> <button class="slotPress" onclick="inv.use(5)"> <p id="slot5">_</p> </button> </div>
    </div>
    
    <div id="overlay"></div>

    <div class="popup" id="coin10">
        <div class="popupcontrols">
            <span id="popupclose"> <button class="close" onclick="coin10Popup.close()">X</button> </span>
        </div>
        <div class="popupcontent">
            <h1 id="coin10Time"> 00:15 </h1> 
        </div>
        
    </div>

    <div class="popup" id="coin25">
        <div class="popupcontrols">
            <span id="popupclose"> <button class="close" onclick="coin25Popup.close()">X</button> </span> <br>
        </div>
        <div class="popupcontent">
            <h1 id="coin25Time"> 00:20 </h1> 
        </div>
        
    </div>

    <div class="popup" id="coin50">
        <div class="popupcontrols">
            <span id="popupclose"> <button class="close" onclick="coin50Popup.close()">X</button> </span>
        </div>
        <div class="popupcontent">
            <h1 id="coin50Time"> 00:35 </h1> 
            <!--<iframe width=500 height=250 src="https://www.youtube.com/embed/Pv0iVoSZzN8?si=_WL-h0lk7dJn_FM7&autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>-->
        </div>
        
    </div>
</body>
</html>

